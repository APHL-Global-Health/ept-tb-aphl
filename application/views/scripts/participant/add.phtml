<form name="participantEdit" id="participantEdit" method="post"   action="<?php echo $this->url(array("controller"=>"participant","action"=>"add","module"=>"default"),null,true) ?>">
<div id="view-content">
<span class="txt" style="margin-left:5em">Participant/Laboratory Information</span>

<input type="hidden" id ="PartSysID" name="participantId" value="<?php echo $this->rsParticipant['participant_id']; ?>" />
<input type="hidden" id ="UsrSysID" name="dataManager" value="<?php echo $this->rsParticipant['data_manager']; ?>" />



	<br>
	
	       <table style="width: 65%;margin: auto;">
				<tr align="left"  class="light">
					<td>Participant System Id <span class="mandatory">*</span></td>
					<td>
					 <input type="text" id="pid" name="pid" size="50" maxlength="45" class="isRequired" title="Please enter the Participant's ID here" placeholder="Please enter the Participant's Unique ID here"
                           onblur="checkDuplicate('participant','unique_identifier',this,null,'This Participant ID already exists for another Participant. Please try something else.')" />
					</td>
				</tr>
				
 
				<tr align="left" class="dark">
					<td>Participant Lab/First Name <span class="mandatory">*</span></td>
					<td><input type="text" id="pfname" name="pfname" size="50" maxlength="45"  class="isRequired"  title="Please enter the Participant's Lab/First Name here" placeholder="Please enter the Participant's Lab/First Name here" /></td>
				</tr>
				<tr align="left" class="light">
					<td>Participant Last Name (optional)</td>
					<td><input type="text" id="plname" name="plname" size="50" maxlength="45" title="Please enter the Participant's Last Name here" placeholder="Please enter the Participant's Last Name here" /></td>
				</tr>
            </tr>
            <tr align="left"  class="dark"> <td>
                <label>Institute Name <span class="mandatory">*</span></label>

               </td><td><input type="text" id="instituteName" name="instituteName" size="50" maxlength="45"
                                             class="isRequired" title="Please enter the Institute Name here"
                                             placeholder="Please enter the Institute Name here" /></td>
            </tr>
            <tr align="left"  class="light"> <td>
                <label>Department Name <span class="mandatory">*</span></label>

               </td><td><input type="text" id="departmentName" name="departmentName" size="50" maxlength="45"
                                             class="isRequired" title="Please enter the Department Name here"
                                             placeholder="Please enter the Department Name here" /></td>
            </tr>
            <tr align="left"  class="dark"> <td>
                <label>Physical Address <span class="mandatory">*</span></label>

               </td><td><textarea id="address" name="address" size="50" 
                                             class="isRequired" title="Please enter the address here"
                                             placeholder="Please enter the address here"></textarea></td>
            </tr>
            <tr align="left"  class="light"> <td>
                <label>City <span class="mandatory">*</span></label>

               </td><td><input type="text" id="city" name="city" size="50" maxlength="45"
                                             class="isRequired" title="Please enter the city here"
                                             placeholder="Please enter the city here"
                                             value="<?php echo $this->rsParticipant['city']; ?>"/></td>
            </tr>
            <tr align="left"  class="dark"> <td>
                <label>State (if applicable)</label>

               </td><td><input type="text" id="state" name="state" size="50" maxlength="45"
                                             class="" title="Please enter the state here"
                                             placeholder="Please enter the state here" /></td>
            </tr>
            <tr align="left"  class="light"> <td>
                <label>Country <span class="mandatory">*</span></label>

               </td><td><input type="text" id="country" name="country" size="50" maxlength="45"
                                             class="isRequired" title="Please enter the country here"
                                             placeholder="Please enter the country here" /></td>
            </tr>
            <tr align="left"  class="dark"> <td>
                <label>Zip Code (if applicable)</label>

               </td><td><input type="text" id="zip" name="zip" size="50" maxlength="45"
                                             class="" title="Please enter the zip here"
                                             placeholder="Please enter the zip here" /></td>
            </tr>
            <tr align="left"  class="light"> <td>
                <label>Longitude </label>

               </td><td><input type="text" id="long" name="long" size="50" maxlength="45"
                                             class="" title="Please enter the longitude here"
                                             placeholder="Please enter the longitude here" /></td>
            </tr>
            <tr align="left"  class="dark"> <td>
                <label>Latitude </label>

               </td><td><input type="text" id="lat" name="lat" size="50" maxlength="45"
                                             class="" title="Please enter the latitude here"
                                             placeholder="Please enter the latitude here" />
											 </td>
            </tr>				
				
				<tr align="left"  class="light">
					<td>Shipping Address (include city and country) <span class="mandatory">*</span></td>
					<td><textarea id="shippingAddress" name="shippingAddress" size="50" 
                                             class="isRequired form-control" title="Please enter the address here"
                                             placeholder="Please enter the Shipping Address here"></textarea></td>
				</tr>

				<tr align="left" class="dark">
					<td>Participant e-mail Address</td>
					<td><input type="text" id="pemail" name="pemail" size="50" maxlength="45" value="<?php echo $this->rsParticipant['email']; ?>" title="Please enter the Participant's Email here" placeholder="Please enter the Participant's Email here" /></td>
				</tr>
				<tr align="left" class="light">
					<td>Participant Phone Number</td>
					<td><input type="text" id="pphone1" name="pphone1" size="50" maxlength="45" value="<?php echo $this->rsParticipant['phone']; ?>" title="Please enter the Participant's Phone here" placeholder="Please enter the Participant's Phone here" class="isNumeric" /></td>
				</tr>
				<tr align="left" class="dark">
					<td>Participant Cell/Mobile Number <span class="mandatory">*</span></td>
					<td><input type="text" id="pphone2" name="pphone2" size="50" maxlength="45" value="<?php echo $this->rsParticipant['mobile']; ?>" class="isRequired isNumeric" title="Please enter the Participant's Mobile Number here" placeholder="Please enter the Participant's Mobile Number here" /></td>
				</tr>
				<tr align="left" class="light">
					<td>Network <span class="mandatory">*</span></td>
					<td>
					<select name="network" id="network"  class="form-control isRequired" title="Please select Network">
						<option value="">--Select--</option>
						<?php foreach($this->networks as $nw){
						?>
						<option value="<?php echo $nw['network_id']; ?>"><?php echo $nw['network_name']; ?></option>
						<?php	
						} ?>
					</select>
					</td>
				</tr>
				<tr align="left" class="dark">
					<td>Participant Affiliation <span class="mandatory">*</span></td>
					<td>
					<select name="partAff" id="partAff"  class="form-control isRequired" title="Please select affiliation">
						<option value="">--Select--</option>
						<?php foreach($this->affiliates as $aff){
						?>
						<option value="<?php echo $aff['affiliate']; ?>"><?php echo $aff['affiliate']; ?></option>
						<?php	
						} ?>
					</select>
					</td>
				</tr>
				
				
			</table>
			<br>
			<div id="respond" style="margin: 0px auto 0px auto; text-align: center;">
				<p>
					<input name="submitbtn" class="button button-rounded button-primary" type="submit"  onclick="validateNow();return false;" tabindex="7" value="Submit"  /> 
					&nbsp;&nbsp;&nbsp;
					<input name="reset" class="button button-rounded button-caution" type="button" id="reset" tabindex="8" value="Cancel" onclick="javascript:goto_testers()" /> 
					
				</p>
			</div>	
</div>			
</form>			



<script>

function goto_testers(){
	window.history.back();
}

    var duplicated = false;
	
    function checkDuplicate(tableName, fieldName, obj, fnct, msg) {
        $.post("<?php echo $this->url(array('module' => 'default', 'controller' => 'common', 'action' => 'check-duplicate')); ?>", { tableName: tableName, fieldName: fieldName, value: obj.value, fnct: fnct, format: "html" },
            function (data) {
                if (data > 0) {
                    alert(msg, "err");
                    duplicated = true;
                    obj.focus();
                }
                else {
                    duplicated = false;
                }
            });
    }
    function validateNow(){
	   checkDuplicate('participant', 'unique_identifier', $("#participantId"), null, 'This Participant ID already exists for another Participant. Please try something else.')
        flag = deforayValidator.init({
            formId: 'participantEdit'
        });
        if (flag && !duplicated) {
            $.blockUI();
            document.getElementById('participantEdit').submit();
        }
    }	 
</script>